{
  "info": {
    "_postman_id": "95efa68c-0bdb-43e4-bf56-ba738d5bb020",
    "name": "SimpleWebApp API Collection",
    "schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json",
    "_exporter_id": "43140997",
    "_collection_link": "https://go.postman.co/collection/43140997-95efa68c-0bdb-43e4-bf56-ba738d5bb020?source=collection_link"
  },
  "item": [
    {
      "name": "Authentication",
      "item": [
        {
          "name": "User Registration",
          "item": [
            {
              "name": "[REG-001] Valid User",
              "event": [
                {
                  "listen": "prerequest",
                  "script": {
                    "exec": [
                      "const ts = Date.now();",
                      "pm.collectionVariables.set('reg_email',    `newuser${ts}@testmail.com`);",
                      "pm.collectionVariables.set('reg_password', 'Str0ng!Pass#2024');"
                    ],
                    "type": "text/javascript",
                    "packages": {},
                    "requests": {}
                  }
                },
                {
                  "listen": "test",
                  "script": {
                    "exec": [
                      "const LIB = JSON.parse(pm.globals.get('LIB') || '{}');",
                      "const jsonData = pm.response.json();",
                      "",
                      "pm.test('Status Code is 201 Created', () => pm.response.to.have.status(201));",
                      "",
                      "pm.test(\"Response indicates success\", function () {",
                      "    pm.expect(jsonData.success).to.be.true;",
                      "    pm.expect(jsonData.message).to.eql(\"User registered successfully\");",
                      "});",
                      "",
                      "pm.test('Response time < 2000 ms', () => pm.expect(pm.response.responseTime).to.be.below(2000));",
                      "",
                      "pm.test('Content-Type is application/json', () => {",
                      "    pm.expect(pm.response.headers.get('Content-Type')).to.include('application/json');",
                      "});",
                      "",
                      "// Schema validation",
                      "const schema = {",
                      "    type: 'object',",
                      "    required: ['id', 'email'],",
                      "    properties: {",
                      "        id:            { type: ['string','number'] },",
                      "        email:         { type: 'string' },",
                      "        createdAt:     { type: 'string' },",
                      "        emailVerified: { type: 'boolean' }",
                      "    },",
                      "    additionalProperties: true",
                      "};",
                      "",
                      "pm.test('Response body matches schema', () => {",
                      "    const d = pm.response.json();",
                      "    pm.expect(tv4.validate(d, schema), tv4.error ? tv4.error.message : '').to.be.true;",
                      "});",
                      "",
                      "pm.test('Email format is valid', () => {",
                      "    const email = pm.response.json().email;",
                      "    pm.expect(LIB.validEmail ? LIB.validEmail(email) : /^[^\\s@]+@[^\\s@]+\\.[^\\s@]+$/.test(email)).to.be.true;",
                      "});",
                      "",
                      "pm.test('Password NOT exposed in response', () => {",
                      "    pm.expect(pm.response.text()).to.not.include(pm.environment.get('reg_password'));",
                      "});",
                      "",
                      "pm.test('User ID is present and non-empty', () => {",
                      "    const id = pm.response.json().id;",
                      "    pm.expect(id).to.exist;",
                      "    pm.expect(String(id).length).to.be.above(0);",
                      "});",
                      "",
                      "pm.test(\"New user is not blocked by default\", function () {",
                      "    pm.expect(jsonData.isBlocked).to.be.false;",
                      "});",
                      "",
                      "if (pm.response.code === 201) {",
                      "    const d = pm.response.json();",
                      "    pm.collectionVariables.set('reg_user_id', d.id);",
                      "    pm.collectionVariables.set('reg_saved_email', d.email);",
                      "    ",
                      "}"
                    ],
                    "type": "text/javascript",
                    "packages": {},
                    "requests": {}
                  }
                }
              ],
              "request": {
                "auth": {
                  "type": "noauth"
                },
                "method": "POST",
                "header": [
                  {
                    "key": "Content-Type",
                    "value": "application/json"
                  }
                ],
                "body": {
                  "mode": "raw",
                  "raw": "{\n    \"email\": \"{{reg_email}}\",\n    \"password\": \"{{reg_password}}\",\n    \"name\": \"TestUser\"\n}",
                  "options": {
                    "raw": {
                      "language": "json"
                    }
                  }
                },
                "url": {
                  "raw": "{{base_url}}/auth/register",
                  "host": [
                    "{{base_url}}"
                  ],
                  "path": [
                    "auth",
                    "register"
                  ]
                },
                "description": "TC-REG-001 to TC-REG-007 | P0 | Happy path — registers new user and validates response schema"
              },
              "response": []
            },
            {
              "name": "[REG-002] Duplicate Email",
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "exec": [
                      "const jsonData = pm.response.json();",
                      "",
                      "pm.test('409 Conflict (or 400) for duplicate email', () => {",
                      "    pm.expect(pm.response.code).to.be.oneOf([400, 409]);",
                      "});",
                      "",
                      "pm.test(\"Response 'success' field is false\", function () {",
                      "    pm.expect(jsonData.success).to.be.false;",
                      "});",
                      "",
                      "pm.test('Error body present', () => {",
                      "    pm.expect(jsonData).to.satisfy(o => o.error || o.message, 'Expected error or message field');",
                      "});",
                      "",
                      "pm.test('Error mentions duplicate/exists/taken', () => {",
                      "    const txt = (jsonData.message || jsonData.error || '').toLowerCase();",
                      "    pm.expect(txt).to.satisfy(t => t.includes('exist') || t.includes('duplicate') || t.includes('taken') || t.includes('already'));",
                      "});",
                      "",
                      "pm.test(\"Response does not contain user data\", function () {",
                      "    pm.expect(jsonData.id).to.be.undefined;",
                      "    pm.expect(jsonData.email).to.be.undefined;",
                      "});"
                    ],
                    "type": "text/javascript",
                    "packages": {},
                    "requests": {}
                  }
                }
              ],
              "request": {
                "auth": {
                  "type": "noauth"
                },
                "method": "POST",
                "header": [
                  {
                    "key": "Content-Type",
                    "value": "application/json"
                  }
                ],
                "body": {
                  "mode": "raw",
                  "raw": "{\n    \"email\": \"{{reg_saved_email}}\",\n    \"password\": \"Another!Pass99\",\n    \"name\": \"DuplicateUser\"\n}",
                  "options": {
                    "raw": {
                      "language": "json"
                    }
                  }
                },
                "url": {
                  "raw": "{{base_url}}/auth/register",
                  "host": [
                    "{{base_url}}"
                  ],
                  "path": [
                    "auth",
                    "register"
                  ]
                },
                "description": "TC-REG-008 to TC-REG-011 | P1 | Duplicate email must be rejected"
              },
              "response": []
            },
            {
              "name": "[REG-003] Invalid Email Format",
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "exec": [
                      "const jsonData = pm.response.json();",
                      "",
                      "pm.test('400 Bad Request for invalid email', () => pm.response.to.have.status(400));",
                      "",
                      "pm.test(\"Response 'success' field is false\", function () {",
                      "    pm.expect(jsonData.success).to.be.false;",
                      "});",
                      "",
                      "pm.test('Error references email', () => {",
                      "    pm.expect(pm.response.text().toLowerCase()).to.include('email');",
                      "});",
                      "",
                      "pm.test(\"Response does not contain user data\", function () {",
                      "    pm.expect(jsonData.id).to.be.undefined;",
                      "    pm.expect(jsonData.email).to.be.undefined;",
                      "});",
                      "",
                      "",
                      "",
                      "",
                      "",
                      "",
                      "",
                      ""
                    ],
                    "type": "text/javascript",
                    "packages": {},
                    "requests": {}
                  }
                },
                {
                  "listen": "prerequest",
                  "script": {
                    "exec": [
                      ""
                    ],
                    "type": "text/javascript",
                    "packages": {},
                    "requests": {}
                  }
                }
              ],
              "request": {
                "auth": {
                  "type": "noauth"
                },
                "method": "POST",
                "header": [
                  {
                    "key": "Content-Type",
                    "value": "application/json"
                  }
                ],
                "body": {
                  "mode": "raw",
                  "raw": "{\n    \n    \"email\": \"not-an-email\",\n    \"password\": \"Str0ng!Pass\",\n    \"name\": \"User with invalidEmail\"\n}",
                  "options": {
                    "raw": {
                      "language": "json"
                    }
                  }
                },
                "url": {
                  "raw": "{{base_url}}/auth/register",
                  "host": [
                    "{{base_url}}"
                  ],
                  "path": [
                    "auth",
                    "register"
                  ]
                },
                "description": "TC-REG-012 to TC-REG-013 | P1 | Malformed email rejected"
              },
              "response": []
            },
            {
              "name": "[REG-004] Weak Password",
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "exec": [
                      "const jsonData = pm.response.json();",
                      "",
                      "pm.test('400 Bad Request for weak password', () => pm.response.to.have.status(400));",
                      "",
                      "pm.test(\"Response 'success' field is false\", function () {",
                      "    pm.expect(jsonData.success).to.be.false;",
                      "});",
                      "",
                      "pm.test('Error references password', () => {",
                      "    pm.expect(pm.response.text().toLowerCase()).to.include('password');",
                      "});",
                      "",
                      "pm.test(\"Response does not contain user data\", function () {",
                      "    pm.expect(jsonData.id).to.be.undefined;",
                      "    pm.expect(jsonData.email).to.be.undefined;",
                      "    pm.expect(jsonData.password).to.be.undefined;",
                      "});",
                      ""
                    ],
                    "type": "text/javascript",
                    "packages": {},
                    "requests": {}
                  }
                }
              ],
              "request": {
                "auth": {
                  "type": "noauth"
                },
                "method": "POST",
                "header": [
                  {
                    "key": "Content-Type",
                    "value": "application/json"
                  }
                ],
                "body": {
                  "mode": "raw",
                  "raw": "{\n    \"username\": \"testuser\",\n    \"email\": \"weak@test.com\",\n    \"password\": \"123\",\n    \"name\": \"User with weakPass\"\n}",
                  "options": {
                    "raw": {
                      "language": "json"
                    }
                  }
                },
                "url": {
                  "raw": "{{base_url}}/auth/register",
                  "host": [
                    "{{base_url}}"
                  ],
                  "path": [
                    "auth",
                    "register"
                  ]
                },
                "description": "TC-REG-014 to TC-REG-015 | P1 | Short/weak password rejected"
              },
              "response": []
            },
            {
              "name": "[REG-005] Missing Multiple Required Fields",
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "exec": [
                      "const jsonData = pm.response.json();",
                      "",
                      "pm.test('400 for missing required fields', () => pm.response.to.have.status(400));",
                      "",
                      "pm.test(\"Response 'success' field is false\", function () {",
                      "    pm.expect(jsonData.success).to.be.false;",
                      "});",
                      "",
                      "pm.test('Error mentions required/missing', () => {",
                      "    const txt = pm.response.text().toLowerCase();",
                      "    pm.expect(txt).to.satisfy(t => t.includes('required') || t.includes('missing'));",
                      "});",
                      "",
                      "pm.test(\"Response does not contain user data\", function () {",
                      "    pm.expect(jsonData.id).to.be.undefined;",
                      "    pm.expect(jsonData.email).to.be.undefined;",
                      "    pm.expect(jsonData.password).to.be.undefined;",
                      "});"
                    ],
                    "type": "text/javascript",
                    "packages": {},
                    "requests": {}
                  }
                }
              ],
              "request": {
                "auth": {
                  "type": "noauth"
                },
                "method": "POST",
                "header": [
                  {
                    "key": "Content-Type",
                    "value": "application/json"
                  }
                ],
                "body": {
                  "mode": "raw",
                  "raw": "{\n    \"email\": \"missing@test.com\"\n}",
                  "options": {
                    "raw": {
                      "language": "json"
                    }
                  }
                },
                "url": {
                  "raw": "{{base_url}}/auth/register",
                  "host": [
                    "{{base_url}}"
                  ],
                  "path": [
                    "auth",
                    "register"
                  ]
                },
                "description": "TC-REG-016 to TC-REG-017 | P1 | Missing fields validation"
              },
              "response": []
            },
            {
              "name": "[REG-006 ] Missing Email Field",
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "exec": [
                      "const jsonData = pm.response.json();",
                      "",
                      "pm.test('400 for missing email field', () => pm.response.to.have.status(400));",
                      "",
                      "pm.test(\"Response 'success' field is false\", function () {",
                      "    pm.expect(jsonData.success).to.be.false;",
                      "});",
                      "",
                      "pm.test('Error mentions email required/missing', () => {",
                      "    const txt = pm.response.text().toLowerCase();",
                      "    pm.expect(txt).to.satisfy(t => t.includes('required') || t.includes('missing') || t.includes('email'));",
                      "});",
                      "",
                      "pm.test(\"Response does not contain user data\", function () {",
                      "    pm.expect(jsonData.id).to.be.undefined;",
                      "    pm.expect(jsonData.email).to.be.undefined;",
                      "    pm.expect(jsonData.password).to.be.undefined;",
                      "});"
                    ],
                    "type": "text/javascript",
                    "packages": {},
                    "requests": {}
                  }
                }
              ],
              "request": {
                "auth": {
                  "type": "noauth"
                },
                "method": "POST",
                "header": [
                  {
                    "key": "Content-Type",
                    "value": "application/json"
                  }
                ],
                "body": {
                  "mode": "raw",
                  "raw": "{ \n    \"password\": \"{{reg_password}}\",\n    \"name\": \"TestUser\"\n}",
                  "options": {
                    "raw": {
                      "language": "json"
                    }
                  }
                },
                "url": {
                  "raw": "{{base_url}}/auth/register",
                  "host": [
                    "{{base_url}}"
                  ],
                  "path": [
                    "auth",
                    "register"
                  ]
                },
                "description": "TC-REG-016 to TC-REG-017 | P1 | Missing fields validation"
              },
              "response": []
            },
            {
              "name": "[REG-007] Missing Password Field",
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "exec": [
                      "const jsonData = pm.response.json();",
                      "",
                      "pm.test('400 for missing email field', () => pm.response.to.have.status(400));",
                      "",
                      "pm.test(\"Response 'success' field is false\", function () {",
                      "    pm.expect(jsonData.success).to.be.false;",
                      "});",
                      "",
                      "pm.test('Error mentions email required/missing', () => {",
                      "    const txt = pm.response.text().toLowerCase();",
                      "    pm.expect(txt).to.satisfy(t => t.includes('required') || t.includes('missing') || t.includes('password'));",
                      "});",
                      "",
                      "pm.test(\"Response does not contain user data\", function () {",
                      "    pm.expect(jsonData.id).to.be.undefined;",
                      "    pm.expect(jsonData.email).to.be.undefined;",
                      "    pm.expect(jsonData.password).to.be.undefined;",
                      "});",
                      ""
                    ],
                    "type": "text/javascript",
                    "packages": {},
                    "requests": {}
                  }
                }
              ],
              "request": {
                "auth": {
                  "type": "noauth"
                },
                "method": "POST",
                "header": [
                  {
                    "key": "Content-Type",
                    "value": "application/json"
                  }
                ],
                "body": {
                  "mode": "raw",
                  "raw": "{\n    \"email\": \"missingPass@test.com\",\n    \"name\": \"TestUser\"\n}",
                  "options": {
                    "raw": {
                      "language": "json"
                    }
                  }
                },
                "url": {
                  "raw": "{{base_url}}/auth/register",
                  "host": [
                    "{{base_url}}"
                  ],
                  "path": [
                    "auth",
                    "register"
                  ]
                },
                "description": "TC-REG-016 to TC-REG-017 | P1 | Missing fields validation"
              },
              "response": []
            },
            {
              "name": "[REG-008] Missing Name Field",
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "exec": [
                      "const jsonData = pm.response.json();",
                      "",
                      "pm.test('400 for missing email field', () => pm.response.to.have.status(400));",
                      "",
                      "pm.test(\"Response 'success' field is false\", function () {",
                      "    pm.expect(jsonData.success).to.be.false;",
                      "});",
                      "",
                      "pm.test('Error mentions email required/missing', () => {",
                      "    const txt = pm.response.text().toLowerCase();",
                      "    pm.expect(txt).to.satisfy(t => t.includes('required') || t.includes('missing') || t.includes('name'));",
                      "});",
                      "",
                      "pm.test(\"Response does not contain user data\", function () {",
                      "    pm.expect(jsonData.id).to.be.undefined;",
                      "    pm.expect(jsonData.email).to.be.undefined;",
                      "    pm.expect(jsonData.password).to.be.undefined;",
                      "});",
                      ""
                    ],
                    "type": "text/javascript",
                    "packages": {},
                    "requests": {}
                  }
                }
              ],
              "request": {
                "auth": {
                  "type": "noauth"
                },
                "method": "POST",
                "header": [
                  {
                    "key": "Content-Type",
                    "value": "application/json"
                  }
                ],
                "body": {
                  "mode": "raw",
                  "raw": "{\n    \"email\": \"missingNamae@test.com\",\n    \"password\": \"{{reg_password}}\"\n    \n}",
                  "options": {
                    "raw": {
                      "language": "json"
                    }
                  }
                },
                "url": {
                  "raw": "{{base_url}}/auth/register",
                  "host": [
                    "{{base_url}}"
                  ],
                  "path": [
                    "auth",
                    "register"
                  ]
                },
                "description": "TC-REG-016 to TC-REG-017 | P1 | Missing fields validation"
              },
              "response": []
            },
            {
              "name": "[REG-009] Empty Body Request",
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "exec": [
                      "const jsonData = pm.response.json();",
                      "",
                      "pm.test('400 for missing email field', () => pm.response.to.have.status(400));",
                      "",
                      "pm.test(\"Response 'success' field is false\", function () {",
                      "    pm.expect(jsonData.success).to.be.false;",
                      "});",
                      "",
                      "pm.test('Error mentions email required/missing', () => {",
                      "    const txt = pm.response.text().toLowerCase();",
                      "    pm.expect(txt).to.satisfy(t => t.includes('required') || t.includes('missing') );",
                      "});",
                      "",
                      "pm.test(\"Response does not contain user data\", function () {",
                      "    pm.expect(jsonData.id).to.be.undefined;",
                      "    pm.expect(jsonData.email).to.be.undefined;",
                      "    pm.expect(jsonData.password).to.be.undefined;",
                      "});",
                      ""
                    ],
                    "type": "text/javascript",
                    "packages": {},
                    "requests": {}
                  }
                }
              ],
              "request": {
                "auth": {
                  "type": "noauth"
                },
                "method": "POST",
                "header": [
                  {
                    "key": "Content-Type",
                    "value": "application/json"
                  }
                ],
                "body": {
                  "mode": "raw",
                  "raw": "{\n    \n}",
                  "options": {
                    "raw": {
                      "language": "json"
                    }
                  }
                },
                "url": {
                  "raw": "{{base_url}}/auth/register",
                  "host": [
                    "{{base_url}}"
                  ],
                  "path": [
                    "auth",
                    "register"
                  ]
                },
                "description": "TC-REG-016 to TC-REG-017 | P1 | Missing fields validation"
              },
              "response": []
            },
            {
              "name": "[REG-010] Unknown Field",
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "exec": [
                      "const jsonData = pm.response.json();",
                      "",
                      "pm.test('400 for missing email field', () => pm.response.to.have.status(400));",
                      "",
                      "pm.test(\"Response 'success' field is false\", function () {",
                      "    pm.expect(jsonData.success).to.be.false;",
                      "});",
                      "",
                      "pm.test('Error mentions email required/missing', () => {",
                      "    const txt = pm.response.text().toLowerCase();",
                      "    pm.expect(txt).to.satisfy(t => t.includes('unknown') || t.includes('allowed') );",
                      "});",
                      "",
                      "pm.test(\"Response does not contain user data\", function () {",
                      "    pm.expect(jsonData.id).to.be.undefined;",
                      "    pm.expect(jsonData.email).to.be.undefined;",
                      "    pm.expect(jsonData.password).to.be.undefined;",
                      "});",
                      ""
                    ],
                    "type": "text/javascript",
                    "packages": {},
                    "requests": {}
                  }
                }
              ],
              "request": {
                "auth": {
                  "type": "noauth"
                },
                "method": "POST",
                "header": [
                  {
                    "key": "Content-Type",
                    "value": "application/json"
                  }
                ],
                "body": {
                  "mode": "raw",
                  "raw": "{\n    \"email\": \"unknown@test.com\",\n    \"password\": \"{{reg_password}}\",\n    \"name\": \"TestUser\",\n    \"unknown\": \"Nothing\"\n}",
                  "options": {
                    "raw": {
                      "language": "json"
                    }
                  }
                },
                "url": {
                  "raw": "{{base_url}}/auth/register",
                  "host": [
                    "{{base_url}}"
                  ],
                  "path": [
                    "auth",
                    "register"
                  ]
                },
                "description": "TC-REG-016 to TC-REG-017 | P1 | Missing fields validation"
              },
              "response": []
            },
            {
              "name": "[REG-011] Whitespace Only Email",
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "exec": [
                      "const jsonData = pm.response.json();",
                      "",
                      "pm.test('[TC-REG-028] 400 for missing email field', () => pm.response.to.have.status(400));",
                      "",
                      "pm.test(\"Response 'success' field is false\", function () {",
                      "    pm.expect(jsonData.success).to.be.false;",
                      "});",
                      "",
                      "pm.test('[TC-REG-029] Error mentions email required/missing', () => {",
                      "    const txt = pm.response.text().toLowerCase();",
                      "    pm.expect(txt).to.satisfy(t => t.includes('email') || t.includes('required') );",
                      "});",
                      "",
                      "pm.test(\"Response does not contain user data\", function () {",
                      "    pm.expect(jsonData.id).to.be.undefined;",
                      "    pm.expect(jsonData.email).to.be.undefined;",
                      "    pm.expect(jsonData.password).to.be.undefined;",
                      "});",
                      ""
                    ],
                    "type": "text/javascript",
                    "packages": {},
                    "requests": {}
                  }
                }
              ],
              "request": {
                "auth": {
                  "type": "noauth"
                },
                "method": "POST",
                "header": [
                  {
                    "key": "Content-Type",
                    "value": "application/json"
                  }
                ],
                "body": {
                  "mode": "raw",
                  "raw": "{\n    \"email\": \"   \",\n    \"password\": \"{{reg_password}}\",\n    \"name\": \"TestUser\"\n}",
                  "options": {
                    "raw": {
                      "language": "json"
                    }
                  }
                },
                "url": {
                  "raw": "{{base_url}}/auth/register",
                  "host": [
                    "{{base_url}}"
                  ],
                  "path": [
                    "auth",
                    "register"
                  ]
                },
                "description": "TC-REG-016 to TC-REG-017 | P1 | Missing fields validation"
              },
              "response": []
            },
            {
              "name": "[REG-012] Password below Min Length",
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "exec": [
                      "const jsonData = pm.response.json();",
                      "",
                      "pm.test('400 and success False for min length password', () => {",
                      "    pm.response.to.have.status(400);",
                      "});",
                      "",
                      "pm.test(\"Response 'success' field is false\", function () {",
                      "    pm.expect(jsonData.success).to.be.false;",
                      "});",
                      "",
                      "pm.test('Password validation error is present', () => {",
                      "    const response = pm.response.json();",
                      "    ",
                      "    const passwordErrors = response.errors.filter(err => err.path === 'password');",
                      "    pm.expect(passwordErrors.length).to.be.at.least(1);",
                      "    ",
                      "    // Check specific error message",
                      "    const hasLengthError = passwordErrors.some(err => ",
                      "        err.msg.includes('at least 8 characters')",
                      "    );",
                      "    ",
                      "    pm.expect(hasLengthError).to.be.true;",
                      "});"
                    ],
                    "type": "text/javascript",
                    "packages": {},
                    "requests": {}
                  }
                }
              ],
              "request": {
                "auth": {
                  "type": "noauth"
                },
                "method": "POST",
                "header": [
                  {
                    "key": "Content-Type",
                    "value": "application/json"
                  }
                ],
                "body": {
                  "mode": "raw",
                  "raw": "{\n    \"email\": \"below@testing.com\",\n    \"password\": \"Pa$$\",\n    \"name\": \"TestUser\"\n}",
                  "options": {
                    "raw": {
                      "language": "json"
                    }
                  }
                },
                "url": {
                  "raw": "{{base_url}}/auth/register",
                  "host": [
                    "{{base_url}}"
                  ],
                  "path": [
                    "auth",
                    "register"
                  ]
                },
                "description": "TC-REG-016 to TC-REG-017 | P1 | Missing fields validation"
              },
              "response": []
            }
          ],
          "description": "Registration endpoint — happy path, validation, and security checks"
        },
        {
          "name": "Login",
          "item": [
            {
              "name": "[LG-001] Valid Credentials",
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "exec": [
                      "// Helper function to decode JWT",
                      "function decodeJWT(token) {",
                      "    try {",
                      "        const base64Url = token.split('.')[1];",
                      "        const base64 = base64Url.replace(/-/g, '+').replace(/_/g, '/');",
                      "        const jsonPayload = decodeURIComponent(atob(base64).split('').map(function(c) {",
                      "            return '%' + ('00' + c.charCodeAt(0).toString(16)).slice(-2);",
                      "        }).join(''));",
                      "        return JSON.parse(jsonPayload);",
                      "    } catch (error) {",
                      "        return null;",
                      "    }",
                      "}",
                      "",
                      "const response = pm.response.json();",
                      "const accessToken = response.accessToken;",
                      "",
                      "pm.test('200 OK', () => pm.response.to.have.status(200));",
                      "",
                      "pm.test('Success flag is true', () => {",
                      "    pm.expect(response.success).to.be.true;",
                      "});",
                      "",
                      "pm.test('Response time < 1500 ms', () => pm.expect(pm.response.responseTime).to.be.below(1500));",
                      "",
                      "const loginSchema = {",
                      "    type: 'object',",
                      "    required: ['success', 'user'],",
                      "    properties: {",
                      "        success: { type: 'boolean', enum: [true] },",
                      "        accessToken: { type: 'string', minLength: 20 },",
                      "        refreshToken: { type: 'string', minLength: 20 },",
                      "        user: {",
                      "            type: 'object',",
                      "            required: ['id', 'email'],",
                      "            properties: {",
                      "                id: { type: ['string', 'number'] },",
                      "                email: { type: 'string' }",
                      "            }",
                      "        }",
                      "    }",
                      "};",
                      "",
                      "pm.test('Response matches schema', () => {",
                      "    pm.response.to.have.jsonSchema(loginSchema);",
                      "});",
                      "",
                      "pm.test('Auth token present and non-empty', () => {",
                      "    const token = response.accessToken || response.token;",
                      "    pm.expect(token).to.be.a('string').with.length.above(20);",
                      "});",
                      "",
                      "//Token tests",
                      "pm.test('Access token has valid JWT format', function() {",
                      "    // JWT should have 3 parts separated by dots",
                      "    const parts = accessToken.split('.');",
                      "    pm.expect(parts.length).to.equal(3);",
                      "    ",
                      "    const base64urlRegex = /^[A-Za-z0-9_-]+$/;",
                      "    pm.expect(parts[0]).to.match(base64urlRegex); // Header",
                      "    pm.expect(parts[1]).to.match(base64urlRegex); // Payload",
                      "    pm.expect(parts[2]).to.match(base64urlRegex); // Signature",
                      "});",
                      "",
                      "pm.test('Access token contains correct user claims', function() {",
                      "    const decodedToken = decodeJWT(accessToken);",
                      "    pm.expect(decodedToken).to.not.be.null;",
                      "    ",
                      "    pm.expect(decodedToken.userId).to.equal(response.user.id);",
                      "});",
                      "",
                      "pm.test('Access token has valid expiration time (exp claim)', function() {",
                      "    const decodedToken = decodeJWT(accessToken);",
                      "    pm.expect(decodedToken).to.not.be.null;",
                      "    pm.expect(decodedToken.exp).to.exist;",
                      "    ",
                      "    // exp should be a number (Unix timestamp)",
                      "    pm.expect(decodedToken.exp).to.be.a('number');",
                      "    ",
                      "    // Check if token is not expired",
                      "    const currentTime = Math.floor(Date.now() / 1000);",
                      "    pm.expect(decodedToken.exp).to.be.above(currentTime);  ",
                      "});",
                      "",
                      "pm.test('Refresh token exists', () => {",
                      "    pm.expect(response.refreshToken).to.be.a('string').with.length.above(20);",
                      "});",
                      "",
                      "pm.test('Refresh token has valid JWT format', function() {",
                      "    const refreshToken = response.refreshToken;",
                      "    const parts = refreshToken.split('.');",
                      "    pm.expect(parts.length).to.equal(3);",
                      "});",
                      "",
                      "pm.test('Refresh token expires later than access token', function() {",
                      "    const accessDecoded = decodeJWT(accessToken);",
                      "    const refreshDecoded = decodeJWT(response.refreshToken);",
                      "    ",
                      "    pm.expect(refreshDecoded.exp).to.be.above(accessDecoded.exp);",
                      "});",
                      "",
                      "pm.test('Password NOT in response', () => {",
                      "    pm.expect(pm.response.text()).to.not.include(pm.environment.get('reg_password'));",
                      "});",
                      "",
                      "pm.test('User data present', () => {",
                      "    pm.expect(response.user).to.have.property('email');",
                      "    pm.expect(response.user).to.have.property('id');",
                      "});",
                      "",
                      "",
                      "if (pm.response.code === 200) {",
                      "    const accessToken = response.accessToken || response.token;",
                      "    const refreshToken = response.refreshToken;",
                      "    ",
                      "    pm.collectionVariables.set('access_token', accessToken);",
                      "    pm.collectionVariables.set('refresh_token', refreshToken);",
                      "    pm.collectionVariables.set('user_id', response.user.id);",
                      "    pm.collectionVariables.set('user_email', response.user.email);",
                      "    ",
                      "    console.log('✓ Tokens saved. Ready for token validation tests.');",
                      "}"
                    ],
                    "type": "text/javascript",
                    "packages": {},
                    "requests": {}
                  }
                },
                {
                  "listen": "prerequest",
                  "script": {
                    "exec": [
                      ""
                    ],
                    "type": "text/javascript",
                    "packages": {},
                    "requests": {}
                  }
                }
              ],
              "request": {
                "auth": {
                  "type": "noauth"
                },
                "method": "POST",
                "header": [
                  {
                    "key": "Content-Type",
                    "value": "application/json"
                  }
                ],
                "body": {
                  "mode": "raw",
                  "raw": "{\n    \"email\": \"{{reg_email}}\",\n    \"password\": \"{{reg_password}}\"\n}",
                  "options": {
                    "raw": {
                      "language": "json"
                    }
                  }
                },
                "url": {
                  "raw": "{{base_url}}/auth/login",
                  "host": [
                    "{{base_url}}"
                  ],
                  "path": [
                    "auth",
                    "login"
                  ]
                },
                "description": "TC-LOGIN-001 to TC-LOGIN-007 | P0 | Successful login + JWT schema validation"
              },
              "response": []
            },
            {
              "name": "[LG-002] Wrong Password",
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "exec": [
                      "",
                      "const response = pm.response.json();",
                      "",
                      "pm.test('401 Unauthorized for wrong password', () => pm.response.to.have.status(401));",
                      "",
                      "pm.test('Success flag is false', () => {",
                      "    pm.expect(response.success).to.be.false;",
                      "});",
                      "",
                      "pm.test('No token in response', () => {",
                      "    pm.expect(response).to.not.have.property('accessToken');",
                      "});",
                      "",
                      "pm.test('Generic error (no user-enumeration leak)', () => {",
                      "    const txt = pm.response.text().toLowerCase();",
                      "    pm.expect(txt).to.satisfy(t => t.includes('invalid') || t.includes('incorrect') || t.includes('unauthorized'));",
                      "    pm.expect(txt).to.not.include('user not found');",
                      "    pm.expect(txt).to.not.include('email does not exist');",
                      "});"
                    ],
                    "type": "text/javascript",
                    "packages": {},
                    "requests": {}
                  }
                }
              ],
              "request": {
                "auth": {
                  "type": "noauth"
                },
                "method": "POST",
                "header": [
                  {
                    "key": "Content-Type",
                    "value": "application/json"
                  }
                ],
                "body": {
                  "mode": "raw",
                  "raw": "{\n    \"email\": \"{{reg_email}}\",\n    \"password\": \"WrongPassword!\"\n}",
                  "options": {
                    "raw": {
                      "language": "json"
                    }
                  }
                },
                "url": {
                  "raw": "{{base_url}}/auth/login",
                  "host": [
                    "{{base_url}}"
                  ],
                  "path": [
                    "auth",
                    "login"
                  ]
                },
                "description": "TC-LOGIN-008 to TC-LOGIN-010 | P1 | Incorrect password + no user-enumeration"
              },
              "response": []
            },
            {
              "name": "[LG-003] Non-existent User",
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "exec": [
                      "const response = pm.response.json();",
                      "",
                      "pm.test('401 for non-existent user', () => pm.response.to.have.status(401));",
                      "",
                      "pm.test('Success flag is false', () => {",
                      "    pm.expect(response.success).to.be.false;",
                      "});",
                      "",
                      "pm.test('No token in response', () => {",
                      "    pm.expect(response).to.not.have.property('accessToken');",
                      "});",
                      "",
                      "pm.test('[Generic error prevents enumeration', () => {",
                      "    const txt = pm.response.text().toLowerCase();",
                      "    pm.expect(txt).to.not.include('user not found');",
                      "    pm.expect(txt).to.not.include('does not exist');",
                      "});"
                    ],
                    "type": "text/javascript",
                    "packages": {},
                    "requests": {}
                  }
                }
              ],
              "request": {
                "auth": {
                  "type": "noauth"
                },
                "method": "POST",
                "header": [
                  {
                    "key": "Content-Type",
                    "value": "application/json"
                  }
                ],
                "body": {
                  "mode": "raw",
                  "raw": "{\n    \"email\": \"ghost_user_99999@test.com\",\n    \"password\": \"SomePass123!\"\n}",
                  "options": {
                    "raw": {
                      "language": "json"
                    }
                  }
                },
                "url": {
                  "raw": "{{base_url}}/auth/login",
                  "host": [
                    "{{base_url}}"
                  ],
                  "path": [
                    "auth",
                    "login"
                  ]
                },
                "description": "TC-LOGIN-011 to TC-LOGIN-012 | P1 | Unknown user + generic error"
              },
              "response": []
            },
            {
              "name": "[LG-004] Case Sensitivity Check",
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "exec": [
                      "const response = pm.response.json();",
                      "",
                      "pm.test('Email case handling documented (200 or 401)', () => {",
                      "    pm.expect(pm.response.code).to.be.oneOf([200, 401]);",
                      "    console.log(pm.response.code === 200 ? 'INFO: Email login is case-insensitive' : 'INFO: Email login is case-sensitive');",
                      "});",
                      "",
                      ""
                    ],
                    "type": "text/javascript",
                    "packages": {},
                    "requests": {}
                  }
                }
              ],
              "request": {
                "auth": {
                  "type": "noauth"
                },
                "method": "POST",
                "header": [
                  {
                    "key": "Content-Type",
                    "value": "application/json"
                  }
                ],
                "body": {
                  "mode": "raw",
                  "raw": "{\n    \"email\": \"SYSADMIN@test.com\",\n    \"password\": \"{{reg_password}}\"\n}",
                  "options": {
                    "raw": {
                      "language": "json"
                    }
                  }
                },
                "url": {
                  "raw": "{{base_url}}/auth/login",
                  "host": [
                    "{{base_url}}"
                  ],
                  "path": [
                    "auth",
                    "login"
                  ]
                },
                "description": "TC-LOGIN-015 | P2 | Documents email case-sensitivity behaviour"
              },
              "response": []
            },
            {
              "name": "[LG-005] Blocked User",
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "exec": [
                      "pm.test(\"Unauthorized 403 for invalid login\", function () {",
                      "    pm.response.to.have.status(403);",
                      "});",
                      "",
                      "pm.test(\"Response has required fields\", function () {",
                      "    const responseData = pm.response.json();",
                      "    ",
                      "    pm.expect(responseData).to.be.an('object');",
                      "    pm.expect(responseData).to.have.all.keys('success', 'message');",
                      "});",
                      "",
                      "pm.test(\"Success field should be false\", function () {",
                      "    const responseData = pm.response.json();",
                      "    pm.expect(responseData.success).to.be.false;",
                      "",
                      "});",
                      "",
                      "pm.test(\"Message field should contain specific text\", function () {",
                      "    const responseData = pm.response.json();",
                      "    pm.expect(responseData.message).to.include(\"Your account is blocked. Please contact\");",
                      "",
                      "}); ",
                      "pm.test(\"Success field should be a boolean\", function () {",
                      "    const responseData = pm.response.json();",
                      "    ",
                      "    pm.expect(responseData).to.be.an('object');",
                      "    pm.expect(responseData.success).to.be.a('boolean');",
                      "});",
                      "",
                      "pm.test(\"Message field should be a string\", function () {",
                      "    const responseData = pm.response.json();",
                      "    ",
                      "    pm.expect(responseData).to.be.an('object');",
                      "    pm.expect(responseData.message).to.be.a('string');",
                      "});",
                      "",
                      ""
                    ],
                    "type": "text/javascript",
                    "packages": {},
                    "requests": {}
                  }
                }
              ],
              "request": {
                "method": "POST",
                "header": [],
                "body": {
                  "mode": "raw",
                  "raw": "{\n    \"email\": \"{{blocked_user}}\",\n    \"password\": \"{{blocked_user_pass}}\"\n}",
                  "options": {
                    "raw": {
                      "language": "json"
                    }
                  }
                },
                "url": {
                  "raw": "{{base_url}}/auth/login",
                  "host": [
                    "{{base_url}}"
                  ],
                  "path": [
                    "auth",
                    "login"
                  ]
                }
              },
              "response": []
            },
            {
              "name": "[LG-006] Missing Email",
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "exec": [
                      "const response = pm.response.json();",
                      "",
                      "pm.test('400 for empty credentials', () => pm.response.to.have.status(400));",
                      "",
                      "pm.test('Success flag is false', () => {",
                      "    pm.expect(response.success).to.be.false;",
                      "});",
                      "",
                      "pm.test('Error mentions required/missing', () => {",
                      "    const txt = pm.response.text().toLowerCase();",
                      "    pm.expect(txt).to.satisfy(t => t.includes('required') || t.includes('missing'));",
                      "});"
                    ],
                    "type": "text/javascript",
                    "packages": {},
                    "requests": {}
                  }
                }
              ],
              "request": {
                "auth": {
                  "type": "noauth"
                },
                "method": "POST",
                "header": [
                  {
                    "key": "Content-Type",
                    "value": "application/json"
                  }
                ],
                "body": {
                  "mode": "raw",
                  "raw": "{\n    \"email\": \"\",\n    \"password\": \"Pa$$word123\"\n}",
                  "options": {
                    "raw": {
                      "language": "json"
                    }
                  }
                },
                "url": {
                  "raw": "{{base_url}}/auth/login",
                  "host": [
                    "{{base_url}}"
                  ],
                  "path": [
                    "auth",
                    "login"
                  ]
                },
                "description": "TC-LOGIN-013 to TC-LOGIN-014 | P1 | Empty fields validation"
              },
              "response": []
            },
            {
              "name": "[LG-007] Missing Password",
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "exec": [
                      "const response = pm.response.json();",
                      "",
                      "pm.test('400 for empty credentials', () => pm.response.to.have.status(400));",
                      "",
                      "pm.test('Success flag is false', () => {",
                      "    pm.expect(response.success).to.be.false;",
                      "});",
                      "",
                      "pm.test('Error mentions required/missing', () => {",
                      "    const txt = pm.response.text().toLowerCase();",
                      "    pm.expect(txt).to.satisfy(t => t.includes('required') || t.includes('missing'));",
                      "});"
                    ],
                    "type": "text/javascript",
                    "packages": {},
                    "requests": {}
                  }
                }
              ],
              "request": {
                "auth": {
                  "type": "noauth"
                },
                "method": "POST",
                "header": [
                  {
                    "key": "Content-Type",
                    "value": "application/json"
                  }
                ],
                "body": {
                  "mode": "raw",
                  "raw": "{\n    \"email\": \"user@test.com\",\n    \"password\": \"\"\n}",
                  "options": {
                    "raw": {
                      "language": "json"
                    }
                  }
                },
                "url": {
                  "raw": "{{base_url}}/auth/login",
                  "host": [
                    "{{base_url}}"
                  ],
                  "path": [
                    "auth",
                    "login"
                  ]
                },
                "description": "TC-LOGIN-013 to TC-LOGIN-014 | P1 | Empty fields validation"
              },
              "response": []
            },
            {
              "name": "[LG-008] Empty Credentials",
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "exec": [
                      "const response = pm.response.json();",
                      "",
                      "pm.test('400 for empty credentials', () => pm.response.to.have.status(400));",
                      "",
                      "pm.test('Success flag is false', () => {",
                      "    pm.expect(response.success).to.be.false;",
                      "});",
                      "",
                      "pm.test('Error mentions required/missing', () => {",
                      "    const txt = pm.response.text().toLowerCase();",
                      "    pm.expect(txt).to.satisfy(t => t.includes('required') || t.includes('missing'));",
                      "});"
                    ],
                    "type": "text/javascript",
                    "packages": {},
                    "requests": {}
                  }
                }
              ],
              "request": {
                "auth": {
                  "type": "noauth"
                },
                "method": "POST",
                "header": [
                  {
                    "key": "Content-Type",
                    "value": "application/json"
                  }
                ],
                "body": {
                  "mode": "raw",
                  "raw": "{\n    \"email\": \"\",\n    \"password\": \"\"\n}",
                  "options": {
                    "raw": {
                      "language": "json"
                    }
                  }
                },
                "url": {
                  "raw": "{{base_url}}/auth/login",
                  "host": [
                    "{{base_url}}"
                  ],
                  "path": [
                    "auth",
                    "login"
                  ]
                },
                "description": "TC-LOGIN-013 to TC-LOGIN-014 | P1 | Empty fields validation"
              },
              "response": []
            },
            {
              "name": "[LG-009] Invalid Email Format",
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "exec": [
                      "const response = pm.response.json();",
                      "",
                      "pm.test('401 for empty credentials', () => pm.response.to.have.status(401));",
                      "",
                      "pm.test('Success flag is false', () => {",
                      "    pm.expect(response.success).to.be.false;",
                      "});",
                      "",
                      "pm.test('Error mentions required/missing', () => {",
                      "    const txt = pm.response.text().toLowerCase();",
                      "    pm.expect(txt).to.satisfy(t => t.includes('invalid'));",
                      "});"
                    ],
                    "type": "text/javascript",
                    "packages": {},
                    "requests": {}
                  }
                }
              ],
              "request": {
                "auth": {
                  "type": "noauth"
                },
                "method": "POST",
                "header": [
                  {
                    "key": "Content-Type",
                    "value": "application/json"
                  }
                ],
                "body": {
                  "mode": "raw",
                  "raw": "{\n    \"email\": \"email\",\n    \"password\": \"Pa$$word123\"\n}",
                  "options": {
                    "raw": {
                      "language": "json"
                    }
                  }
                },
                "url": {
                  "raw": "{{base_url}}/auth/login",
                  "host": [
                    "{{base_url}}"
                  ],
                  "path": [
                    "auth",
                    "login"
                  ]
                },
                "description": "TC-LOGIN-013 to TC-LOGIN-014 | P1 | Empty fields validation"
              },
              "response": []
            },
            {
              "name": "[LG-010] Refresh Token - Valid",
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "exec": [
                      "pm.test('200 OK for valid token refresh', () => pm.response.to.have.status(200));",
                      "pm.test('New access token present', () => {",
                      "    const d = pm.response.json();",
                      "    pm.expect(d.token || d.accessToken).to.be.a('string').and.have.length.above(10);",
                      "});",
                      "pm.test('New token differs from old token', () => {",
                      "    const newTok = pm.response.json().token || pm.response.json().accessToken;",
                      "    const oldTok = pm.environment.get('auth_token');",
                      "    if (oldTok && newTok) pm.expect(newTok).to.not.equal(oldTok);",
                      "});",
                      "if (pm.response.code === 200) {",
                      "    const d = pm.response.json();",
                      "    pm.environment.set('auth_token', d.token || d.accessToken);",
                      "    if (d.refreshToken) pm.environment.set('refresh_token', d.refreshToken);",
                      "}"
                    ],
                    "type": "text/javascript",
                    "packages": {},
                    "requests": {}
                  }
                }
              ],
              "request": {
                "auth": {
                  "type": "noauth"
                },
                "method": "POST",
                "header": [
                  {
                    "key": "Content-Type",
                    "value": "application/json"
                  }
                ],
                "body": {
                  "mode": "raw",
                  "raw": "{\n    \"refreshToken\": \"{{refresh_token}}\"\n}",
                  "options": {
                    "raw": {
                      "language": "json"
                    }
                  }
                },
                "url": {
                  "raw": "{{base_url}}/auth/refresh",
                  "host": [
                    "{{base_url}}"
                  ],
                  "path": [
                    "auth",
                    "refresh"
                  ]
                },
                "description": "TC-TOK-001 to TC-TOK-003 | P1 | Refresh returns new token different from old"
              },
              "response": []
            },
            {
              "name": "[LG-011] Refresh Token - Invalid",
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "exec": [
                      "pm.test('[401 for invalid refresh token', () => pm.response.to.have.status(401));",
                      "pm.test('[No new token for invalid refresh', () => {",
                      "    const d = pm.response.json();",
                      "    pm.expect(d).to.not.have.property('token');",
                      "    pm.expect(d).to.not.have.property('accessToken');",
                      "});"
                    ],
                    "type": "text/javascript",
                    "packages": {},
                    "requests": {}
                  }
                }
              ],
              "request": {
                "auth": {
                  "type": "noauth"
                },
                "method": "POST",
                "header": [
                  {
                    "key": "Content-Type",
                    "value": "application/json"
                  }
                ],
                "body": {
                  "mode": "raw",
                  "raw": "{\n    \"refreshToken\": \"totally_invalid_refresh_token_string\"\n}",
                  "options": {
                    "raw": {
                      "language": "json"
                    }
                  }
                },
                "url": {
                  "raw": "{{base_url}}/auth/refresh",
                  "host": [
                    "{{base_url}}"
                  ],
                  "path": [
                    "auth",
                    "refresh"
                  ]
                },
                "description": "TC-TOK-004 to TC-TOK-005 | P1 | Invalid refresh token rejected"
              },
              "response": []
            }
          ],
          "description": "Login endpoint — authentication, token issuance, security",
          "event": [
            {
              "listen": "prerequest",
              "script": {
                "type": "text/javascript",
                "packages": {},
                "requests": {},
                "exec": [
                  ""
                ]
              }
            },
            {
              "listen": "test",
              "script": {
                "type": "text/javascript",
                "packages": {},
                "requests": {},
                "exec": [
                  ""
                ]
              }
            }
          ]
        },
        {
          "name": "Products - Protected Route",
          "item": [
            {
              "name": "[PR-001] Access Products List - Authenticated",
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "exec": [
                      "const response = pm.response.json();",
                      "",
                      "pm.test('200 OK for authenticated products', () => pm.response.to.have.status(200));",
                      "",
                      "pm.test(\"Response has success = true\", function () {",
                      "    pm.expect(response.success).to.eql(true);",
                      "});",
                      "",
                      "pm.test(\"Products array exists\", function () {",
                      "    pm.expect(response).to.have.property(\"products\");",
                      "    pm.expect(response.products).to.be.an(\"array\");",
                      "});",
                      "pm.test('Response time < 2000 ms', () => pm.expect(pm.response.responseTime).to.be.below(2000));",
                      "",
                      "pm.test(\"Each product has required fields with correct types\", function () {",
                      "    response.products.forEach(product => {",
                      "        pm.expect(product).to.have.property(\"name\").that.is.a(\"string\");",
                      "        pm.expect(product).to.have.property(\"description\").that.is.a(\"string\");",
                      "        pm.expect(product).to.have.property(\"image\").that.is.a(\"string\");",
                      "        pm.expect(product).to.have.property(\"rating\").that.is.a(\"number\");",
                      "        pm.expect(product).to.have.property(\"id\").that.is.a(\"string\");",
                      "    });",
                      "});",
                      "",
                      "pm.test(\"Product ratings are between 0 and 5\", function () {",
                      "    response.products.forEach(product => {",
                      "        pm.expect(product.rating).to.be.within(0, 5);",
                      "    });",
                      "});",
                      "",
                      "pm.test('Content-Type is application/json', () => {",
                      "    pm.expect(pm.response.headers.get('Content-Type')).to.include('application/json');",
                      "});"
                    ],
                    "type": "text/javascript",
                    "packages": {},
                    "requests": {}
                  }
                }
              ],
              "request": {
                "auth": {
                  "type": "bearer",
                  "bearer": [
                    {
                      "key": "token",
                      "value": "{{access_token}}",
                      "type": "string"
                    }
                  ]
                },
                "method": "GET",
                "header": [
                  {
                    "key": "Content-Type",
                    "value": "application/json"
                  }
                ],
                "url": {
                  "raw": "{{base_url}}/products",
                  "host": [
                    "{{base_url}}"
                  ],
                  "path": [
                    "products"
                  ]
                },
                "description": "TC-PROD-001 to TC-PROD-005 | P0 | Authenticated product retrieval + schema"
              },
              "response": []
            },
            {
              "name": "[PR-002] Create Product",
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "exec": [
                      "const response = pm.response.json();",
                      "",
                      "pm.test('201 OK for authenticated products', () => pm.response.to.have.status(201));",
                      "",
                      "pm.test(\"Response has success = true\", function () {",
                      "    pm.expect(response.success).to.eql(true);",
                      "});",
                      "",
                      "pm.test('Response time < 2000 ms', () => pm.expect(pm.response.responseTime).to.be.below(2000));",
                      "",
                      "pm.test(\"Validate data types\", function () {",
                      "    pm.expect(response.success).to.be.a('boolean');",
                      "    pm.expect(response.product.name).to.be.a('string');",
                      "    pm.expect(response.product.rating).to.be.a('number');",
                      "    pm.expect(response.product.id).to.have.lengthOf(24); ",
                      "});",
                      "",
                      "pm.test(\"Product details are valid\", function () {",
                      "    ",
                      "    pm.expect(response.product.name).to.not.be.empty;",
                      "    pm.expect(response.product.description).to.not.be.empty;",
                      "    pm.expect(response.product.rating).to.be.within(0, 5);",
                      "});",
                      "",
                      "pm.test('Content-Type is application/json', () => {",
                      "    pm.expect(pm.response.headers.get('Content-Type')).to.include('application/json');",
                      "});",
                      "",
                      "if (pm.response.code === 201) {",
                      "    pm.expect(response.product).to.have.property('id');",
                      "    ",
                      "    const productId = response.product.id;",
                      "    pm.collectionVariables.set(\"product_id\", productId);",
                      "    ",
                      "    console.log(\"Saved ID to collectionVariables: \", productId);",
                      "}"
                    ],
                    "type": "text/javascript",
                    "packages": {},
                    "requests": {}
                  }
                }
              ],
              "request": {
                "auth": {
                  "type": "bearer",
                  "bearer": [
                    {
                      "key": "token",
                      "value": "{{access_token}}",
                      "type": "string"
                    }
                  ]
                },
                "method": "POST",
                "header": [
                  {
                    "key": "Content-Type",
                    "value": "application/json"
                  }
                ],
                "body": {
                  "mode": "raw",
                  "raw": "{\n        \"name\": \"Laptop API\",\n        \"description\": \"This is a new Laptop\",\n        \"image\": \"https://fastly.picsum.photos/id/0/367/267.jpg?hmac=7vvdjNHaShwe3Ul3DAaQIBBz0RnNLfUcEaCV-94NNLE\",\n        \"rating\": 4.2\n}",
                  "options": {
                    "raw": {
                      "language": "json"
                    }
                  }
                },
                "url": {
                  "raw": "{{base_url}}/products",
                  "host": [
                    "{{base_url}}"
                  ],
                  "path": [
                    "products"
                  ]
                },
                "description": "TC-PROD-001 to TC-PROD-005 | P0 | Authenticated product retrieval + schema"
              },
              "response": []
            },
            {
              "name": "[PR-003] Find Product by ID",
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "exec": [
                      "const response = pm.response.json();",
                      "",
                      "pm.test('200 OK for authenticated products', () => pm.response.to.have.status(200));",
                      "",
                      "pm.test(\"Response has success = true\", function () {",
                      "    pm.expect(response.success).to.eql(true);",
                      "});",
                      "",
                      "pm.test('Response time < 2000 ms', () => pm.expect(pm.response.responseTime).to.be.below(2000));",
                      "",
                      "pm.test(\"Validate data types\", function () {",
                      "    pm.expect(response.success).to.be.a('boolean');",
                      "    pm.expect(response.product.name).to.be.a('string');",
                      "    pm.expect(response.product.rating).to.be.a('number');",
                      "    pm.expect(response.product.id).to.have.lengthOf(24); ",
                      "});",
                      "",
                      "pm.test(\"Product details are valid\", function () {",
                      "    ",
                      "    pm.expect(response.product.name).to.not.be.empty;",
                      "    pm.expect(response.product.description).to.not.be.empty;",
                      "    pm.expect(response.product.rating).to.be.within(0, 5);",
                      "});",
                      "",
                      "pm.test('Content-Type is application/json', () => {",
                      "    pm.expect(pm.response.headers.get('Content-Type')).to.include('application/json');",
                      "});",
                      "",
                      "if (pm.response.code === 201) {",
                      "    pm.expect(response.product).to.have.property('id');",
                      "    ",
                      "    const productId = response.product.id;",
                      "    pm.collectionVariables.set(\"product_id\", productId);",
                      "    ",
                      "    console.log(\"Saved ID to collectionVariables: \", productId);",
                      "}"
                    ],
                    "type": "text/javascript",
                    "packages": {},
                    "requests": {}
                  }
                }
              ],
              "protocolProfileBehavior": {
                "disableBodyPruning": true
              },
              "request": {
                "auth": {
                  "type": "bearer",
                  "bearer": [
                    {
                      "key": "token",
                      "value": "{{access_token}}",
                      "type": "string"
                    }
                  ]
                },
                "method": "GET",
                "header": [
                  {
                    "key": "Content-Type",
                    "value": "application/json"
                  }
                ],
                "body": {
                  "mode": "raw",
                  "raw": "",
                  "options": {
                    "raw": {
                      "language": "json"
                    }
                  }
                },
                "url": {
                  "raw": "{{base_url}}/products/{{product_id}}",
                  "host": [
                    "{{base_url}}"
                  ],
                  "path": [
                    "products",
                    "{{product_id}}"
                  ]
                },
                "description": "TC-PROD-001 to TC-PROD-005 | P0 | Authenticated product retrieval + schema"
              },
              "response": []
            },
            {
              "name": "[PR-004] Update Product Info",
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "exec": [
                      "const response = pm.response.json();",
                      "",
                      "pm.test('200 OK for authenticated products', () => pm.response.to.have.status(200));",
                      "",
                      "pm.test(\"Response has success = true\", function () {",
                      "    pm.expect(response.success).to.eql(true);",
                      "});",
                      "",
                      "pm.test('Response time < 2000 ms', () => pm.expect(pm.response.responseTime).to.be.below(2000));",
                      "",
                      "pm.test(\"Validate data types\", function () {",
                      "    pm.expect(response.success).to.be.a('boolean');",
                      "    pm.expect(response.product.name).to.be.a('string');",
                      "    pm.expect(response.product.rating).to.be.a('number');",
                      "    pm.expect(response.product.id).to.have.lengthOf(24); ",
                      "});",
                      "",
                      "pm.test(\"Product Info Updated successfully\", function () {",
                      "    ",
                      "    pm.expect(response.product.name).to.eql(\"Product Info Updated\");",
                      "    pm.expect(response.product.description).to.not.be.empty;",
                      "    pm.expect(response.product.rating).to.be.within(0, 5);",
                      "});",
                      "",
                      "pm.test('Content-Type is application/json', () => {",
                      "    pm.expect(pm.response.headers.get('Content-Type')).to.include('application/json');",
                      "});",
                      "",
                      ""
                    ],
                    "type": "text/javascript",
                    "packages": {},
                    "requests": {}
                  }
                }
              ],
              "request": {
                "auth": {
                  "type": "bearer",
                  "bearer": [
                    {
                      "key": "token",
                      "value": "{{access_token}}",
                      "type": "string"
                    }
                  ]
                },
                "method": "PUT",
                "header": [
                  {
                    "key": "Content-Type",
                    "value": "application/json"
                  }
                ],
                "body": {
                  "mode": "raw",
                  "raw": "{\n\t\"name\": \"Product Info Updated\"\n}",
                  "options": {
                    "raw": {
                      "language": "json"
                    }
                  }
                },
                "url": {
                  "raw": "{{base_url}}/products/{{product_id}}",
                  "host": [
                    "{{base_url}}"
                  ],
                  "path": [
                    "products",
                    "{{product_id}}"
                  ]
                },
                "description": "TC-PROD-001 to TC-PROD-005 | P0 | Authenticated product retrieval + schema"
              },
              "response": []
            },
            {
              "name": "[PR-005] Update Product Info Copy",
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "exec": [
                      "const response = pm.response.json();",
                      "",
                      "pm.test('200 OK for authenticated products', () => pm.response.to.have.status(200));",
                      "",
                      "pm.test(\"Response has success = true\", function () {",
                      "    pm.expect(response.success).to.eql(true);",
                      "});",
                      "",
                      "pm.test('Response time < 2000 ms', () => pm.expect(pm.response.responseTime).to.be.below(2000));",
                      "",
                      "pm.test(\"Product Info Deleted successfully\", function () {",
                      "    ",
                      "    pm.expect(response.message).to.eql(\"Product deleted\");",
                      "});",
                      "",
                      "pm.test('Content-Type is application/json', () => {",
                      "    pm.expect(pm.response.headers.get('Content-Type')).to.include('application/json');",
                      "});",
                      "",
                      ""
                    ],
                    "type": "text/javascript",
                    "packages": {},
                    "requests": {}
                  }
                }
              ],
              "request": {
                "auth": {
                  "type": "bearer",
                  "bearer": [
                    {
                      "key": "token",
                      "value": "{{access_token}}",
                      "type": "string"
                    }
                  ]
                },
                "method": "DELETE",
                "header": [
                  {
                    "key": "Content-Type",
                    "value": "application/json"
                  }
                ],
                "body": {
                  "mode": "raw",
                  "raw": "{\n\t\"name\": \"Deleted Product\"\n}",
                  "options": {
                    "raw": {
                      "language": "json"
                    }
                  }
                },
                "url": {
                  "raw": "{{base_url}}/products/{{product_id}}",
                  "host": [
                    "{{base_url}}"
                  ],
                  "path": [
                    "products",
                    "{{product_id}}"
                  ]
                },
                "description": "TC-PROD-001 to TC-PROD-005 | P0 | Authenticated product retrieval + schema"
              },
              "response": []
            },
            {
              "name": "[PR-006] Access Products List - Unauthenticated",
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "exec": [
                      "pm.test('401 for unauthenticated products request', () => pm.response.to.have.status(401));",
                      "pm.test('No product data returned without auth', () => {",
                      "    const d = pm.response.json();",
                      "    pm.expect(Array.isArray(d)).to.be.false;",
                      "});"
                    ],
                    "type": "text/javascript",
                    "packages": {},
                    "requests": {}
                  }
                }
              ],
              "request": {
                "auth": {
                  "type": "noauth"
                },
                "method": "GET",
                "header": [
                  {
                    "key": "Content-Type",
                    "value": "application/json"
                  }
                ],
                "url": {
                  "raw": "{{base_url}}/products",
                  "host": [
                    "{{base_url}}"
                  ],
                  "path": [
                    "products"
                  ]
                },
                "description": "TC-PROD-006 to TC-PROD-007 | P1 | Protected resource rejects no-auth"
              },
              "response": []
            },
            {
              "name": "[PR-007] Access Products List - Invalid Token",
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "exec": [
                      "pm.test('401 for invalid bearer token', () => pm.response.to.have.status(401));",
                      "pm.test('Error indicates invalid/expired token', () => {",
                      "    const txt = pm.response.text().toLowerCase();",
                      "    pm.expect(txt).to.satisfy(t => t.includes('invalid') || t.includes('token') || t.includes('unauthorized'));",
                      "});"
                    ],
                    "type": "text/javascript",
                    "packages": {},
                    "requests": {}
                  }
                }
              ],
              "request": {
                "auth": {
                  "type": "bearer",
                  "bearer": [
                    {
                      "key": "token",
                      "value": "invalid.jwt.payload.here",
                      "type": "string"
                    }
                  ]
                },
                "method": "GET",
                "header": [
                  {
                    "key": "Content-Type",
                    "value": "application/json"
                  }
                ],
                "url": {
                  "raw": "{{base_url}}/products",
                  "host": [
                    "{{base_url}}"
                  ],
                  "path": [
                    "products"
                  ]
                },
                "description": "TC-PROD-008 to TC-PROD-009 | P1 | Forged token rejected"
              },
              "response": []
            },
            {
              "name": "[PR-008] Access Products List - Expired Token",
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "exec": [
                      "// Test 1: Verify unauthorized status",
                      "pm.test(\"Status code is 401 Unauthorized\", function () {",
                      "    pm.response.to.have.status(401);",
                      "});",
                      "",
                      "// Test 2: Verify error indicates token expiration",
                      "pm.test(\"Error message indicates expired token\", function () {",
                      "    var responseText = pm.response.text().toLowerCase();",
                      "    pm.expect(responseText).to.satisfy(function(text) {",
                      "        return text.includes('expired') || text.includes('invalid') || text.includes('token');",
                      "    });",
                      "});"
                    ],
                    "type": "text/javascript",
                    "packages": {},
                    "requests": {}
                  }
                }
              ],
              "request": {
                "auth": {
                  "type": "bearer",
                  "bearer": [
                    {
                      "key": "token",
                      "value": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMjM0NTY3ODkwIiwibmFtZSI6IkpvaG4gRG9lIiwiaWF0IjoxNTE2MjM5MDIyLCJleHAiOjE1MTYyMzkwMjJ9.SflKxwRJSMeKKF2QT4fwpMeJf36POk6yJV_adQssw5c",
                      "type": "string"
                    }
                  ]
                },
                "method": "GET",
                "header": [
                  {
                    "key": "Content-Type",
                    "value": "application/json"
                  }
                ],
                "url": {
                  "raw": "{{base_url}}/products",
                  "host": [
                    "{{base_url}}"
                  ],
                  "path": [
                    "products"
                  ]
                },
                "description": "Test products endpoint rejects expired authentication token"
              },
              "response": []
            },
            {
              "name": "[PR-009] ]Products - Tampered JWT",
              "event": [
                {
                  "listen": "prerequest",
                  "script": {
                    "exec": [
                      "const tok = pm.environment.get('auth_token') || '';",
                      "const parts = tok.split('.');",
                      "if (parts.length === 3) {",
                      "    // Flip last char of signature",
                      "    const sig = parts[2];",
                      "    const tampered = sig.slice(0,-1) + (sig.slice(-1) === 'A' ? 'B' : 'A');",
                      "    pm.environment.set('tampered_token', parts[0] + '.' + parts[1] + '.' + tampered);",
                      "} else {",
                      "    pm.environment.set('tampered_token', 'tampered.invalid.token');",
                      "}"
                    ],
                    "type": "text/javascript",
                    "packages": {},
                    "requests": {}
                  }
                },
                {
                  "listen": "test",
                  "script": {
                    "exec": [
                      "pm.test('Tampered JWT rejected (401)', () => pm.response.to.have.status(401));",
                      "pm.test('No data returned for tampered token', () => {",
                      "    pm.expect(Array.isArray(pm.response.json())).to.be.false;",
                      "});"
                    ],
                    "type": "text/javascript",
                    "packages": {},
                    "requests": {}
                  }
                }
              ],
              "request": {
                "auth": {
                  "type": "bearer",
                  "bearer": [
                    {
                      "key": "token",
                      "value": "{{tampered_token}}",
                      "type": "string"
                    }
                  ]
                },
                "method": "GET",
                "header": [
                  {
                    "key": "Content-Type",
                    "value": "application/json"
                  }
                ],
                "url": {
                  "raw": "{{base_url}}/products",
                  "host": [
                    "{{base_url}}"
                  ],
                  "path": [
                    "products"
                  ]
                },
                "description": "TC-SEC-008 to TC-SEC-009 | P0 | Signature-tampered JWT must be rejected"
              },
              "response": []
            }
          ],
          "description": "Products endpoint — authenticated access and token validation"
        },
        {
          "name": "Logout",
          "item": [
            {
              "name": "[LGO-001] Authenticated",
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "exec": [
                      "pm.test('200 or 204 for authenticated logout', () => {",
                      "    pm.expect(pm.response.code).to.be.oneOf([200, 204]);",
                      "});",
                      "",
                      "if (pm.response.code === 200) {",
                      "    pm.test('[TC-LGOUT-002] Success message returned', () => {",
                      "        const d = pm.response.json();",
                      "        pm.expect(d).to.satisfy(o => o.message || o.success);",
                      "    });",
                      "}",
                      "pm.environment.unset('auth_token');",
                      "pm.environment.unset('refresh_token');"
                    ],
                    "type": "text/javascript",
                    "packages": {},
                    "requests": {}
                  }
                }
              ],
              "request": {
                "auth": {
                  "type": "bearer",
                  "bearer": [
                    {
                      "key": "token",
                      "value": "{{access_token}}",
                      "type": "string"
                    }
                  ]
                },
                "method": "POST",
                "header": [
                  {
                    "key": "Content-Type",
                    "value": "application/json"
                  }
                ],
                "url": {
                  "raw": "{{base_url}}/auth/logout",
                  "host": [
                    "{{base_url}}"
                  ],
                  "path": [
                    "auth",
                    "logout"
                  ]
                },
                "description": "TC-LGOUT-001 to TC-LGOUT-002 | P0 | Logout clears session and tokens"
              },
              "response": []
            },
            {
              "name": "[LGO-002] Unauthenticated",
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "exec": [
                      "pm.test('[401 for unauthenticated logout', () => {",
                      "    pm.expect(pm.response.code).to.be.oneOf([200, 401]);",
                      "});"
                    ],
                    "type": "text/javascript",
                    "packages": {},
                    "requests": {}
                  }
                }
              ],
              "request": {
                "auth": {
                  "type": "noauth"
                },
                "method": "POST",
                "header": [
                  {
                    "key": "Content-Type",
                    "value": "application/json"
                  }
                ],
                "url": {
                  "raw": "{{base_url}}/auth/logout",
                  "host": [
                    "{{base_url}}"
                  ],
                  "path": [
                    "auth",
                    "logout"
                  ]
                },
                "description": "TC-LGOUT-003 | P2 | Unauthenticated logout handled gracefully"
              },
              "response": []
            }
          ],
          "description": "Logout — session termination"
        }
      ],
      "description": "Full functional coverage — all endpoints, positive + negative scenarios"
    },
    {
      "name": "Performance Tests",
      "item": [
        {
          "name": "Response Time SLAs",
          "item": [
            {
              "name": "[PER-001] Login - P95 / P99 Latency Thresholds ⏱",
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "exec": [
                      "pm.test('Login P95 < 1500 ms', () => pm.expect(pm.response.responseTime).to.be.below(1500));",
                      "",
                      "pm.test('Login P99 < 2500 ms (logged only)', () => {",
                      "    console.log('Response time:', pm.response.responseTime, 'ms');",
                      "    pm.expect(pm.response.responseTime).to.be.below(2500);",
                      "});",
                      "",
                      "pm.test('Response size < 50 KB', () => {",
                      "    pm.expect(pm.response.size().total).to.be.below(50 * 1024);",
                      "});",
                      "",
                      "if (pm.response.code === 200) {",
                      "    const response = pm.response.json();",
                      "    const accessToken = response.accessToken || response.token;",
                      "    const refreshToken = response.refreshToken;",
                      "    ",
                      "    pm.collectionVariables.set('access_token', accessToken);",
                      "    pm.collectionVariables.set('refresh_token', refreshToken);",
                      "    console.log('✓ Tokens saved.');",
                      "}",
                      "console.log('Metrics | time:', pm.response.responseTime, 'ms | size:', pm.response.size().total, 'bytes');"
                    ],
                    "type": "text/javascript",
                    "packages": {},
                    "requests": {}
                  }
                }
              ],
              "request": {
                "auth": {
                  "type": "noauth"
                },
                "method": "POST",
                "header": [
                  {
                    "key": "Content-Type",
                    "value": "application/json"
                  }
                ],
                "body": {
                  "mode": "raw",
                  "raw": "{\n    \"email\": \"{{reg_email}}\",\n    \"password\": \"{{reg_password}}\"\n}",
                  "options": {
                    "raw": {
                      "language": "json"
                    }
                  }
                },
                "url": {
                  "raw": "{{base_url}}/auth/login",
                  "host": [
                    "{{base_url}}"
                  ],
                  "path": [
                    "auth",
                    "login"
                  ]
                },
                "description": "TC-PERF-001 to TC-PERF-003 | P1 | Login must be < 1500 ms (P95), < 2500 ms (P99)"
              },
              "response": []
            },
            {
              "name": "[PER-002] Products - Response Time & Payload Size ⏱",
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "exec": [
                      "pm.test('Products response < 2000 ms', () => pm.expect(pm.response.responseTime).to.be.below(2000));",
                      "",
                      "pm.test('Products response < 500 KB', () => {",
                      "    pm.expect(pm.response.size().total).to.be.below(500 * 1024);",
                      "});"
                    ],
                    "type": "text/javascript",
                    "packages": {},
                    "requests": {}
                  }
                }
              ],
              "request": {
                "auth": {
                  "type": "bearer",
                  "bearer": [
                    {
                      "key": "token",
                      "value": "{{access_token}}",
                      "type": "string"
                    }
                  ]
                },
                "method": "GET",
                "header": [
                  {
                    "key": "Content-Type",
                    "value": "application/json"
                  }
                ],
                "url": {
                  "raw": "{{base_url}}/products",
                  "host": [
                    "{{base_url}}"
                  ],
                  "path": [
                    "products"
                  ]
                },
                "description": "TC-PERF-004 to TC-PERF-005 | P1 | Products < 2000 ms and < 500 KB"
              },
              "response": []
            }
          ]
        },
        {
          "name": "Rate Limiting",
          "item": [
            {
              "name": "[PER-003] Login - Rate-Limit Headers Logged",
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "exec": [
                      "pm.test('Not rate-limited', () => pm.expect(pm.response.code).to.not.equal(429));",
                      "",
                      "pm.test('Rate-limit headers logged', () => {",
                      "    const rem   = pm.response.headers.get('X-RateLimit-Remaining');",
                      "    const limit = pm.response.headers.get('X-RateLimit-Limit');",
                      "    console.log('RateLimit-Limit:', limit, '| Remaining:', rem);",
                      "    pm.expect(true).to.be.true; ",
                      "});"
                    ],
                    "type": "text/javascript",
                    "packages": {},
                    "requests": {}
                  }
                }
              ],
              "request": {
                "auth": {
                  "type": "noauth"
                },
                "method": "POST",
                "header": [
                  {
                    "key": "Content-Type",
                    "value": "application/json"
                  }
                ],
                "body": {
                  "mode": "raw",
                  "raw": "{\n    \"email\": \"{{reg_email}}\",\n    \"password\": \"{{reg_password}}\"\n}",
                  "options": {
                    "raw": {
                      "language": "json"
                    }
                  }
                },
                "url": {
                  "raw": "{{base_url}}/auth/login",
                  "host": [
                    "{{base_url}}"
                  ],
                  "path": [
                    "auth",
                    "login"
                  ]
                },
                "description": "TC-PERF-008 to TC-PERF-009 | P2 | Rate-limit headers logged; request must not be throttled"
              },
              "response": []
            }
          ]
        },
        {
          "name": "Caching",
          "item": [
            {
              "name": "[PER-004] Products - Cache Headers Present",
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "exec": [
                      "pm.test('Cache-Control or ETag header present', () => {",
                      "    const hasCC  = pm.response.headers.has('Cache-Control');",
                      "    const hasET  = pm.response.headers.has('ETag');",
                      "    const hasExp = pm.response.headers.has('Expires');",
                      "    console.log('Cache-Control:', pm.response.headers.get('Cache-Control'));",
                      "    console.log('ETag:', pm.response.headers.get('ETag'));",
                      "    pm.expect(hasCC || hasET || hasExp).to.be.true;",
                      "});"
                    ],
                    "type": "text/javascript",
                    "packages": {},
                    "requests": {}
                  }
                }
              ],
              "request": {
                "auth": {
                  "type": "bearer",
                  "bearer": [
                    {
                      "key": "token",
                      "value": "{{access_token}}",
                      "type": "string"
                    }
                  ]
                },
                "method": "GET",
                "header": [
                  {
                    "key": "Content-Type",
                    "value": "application/json"
                  }
                ],
                "url": {
                  "raw": "{{base_url}}/products",
                  "host": [
                    "{{base_url}}"
                  ],
                  "path": [
                    "products"
                  ]
                },
                "description": "TC-PERF-006 | P2 | Cache-Control / ETag must be present for products"
              },
              "response": []
            }
          ]
        },
        {
          "name": "Compression",
          "item": [
            {
              "name": "[PER-004] Products -  Compression Enabled",
              "event": [
                {
                  "listen": "prerequest",
                  "script": {
                    "exec": [
                      ""
                    ],
                    "type": "text/javascript",
                    "packages": {},
                    "requests": {}
                  }
                },
                {
                  "listen": "test",
                  "script": {
                    "exec": [
                      "pm.test('Compression applied (gzip/br/deflate)', () => {",
                      "    const enc = pm.response.headers.get('Content-Encoding');",
                      "    if (enc) {",
                      "        pm.expect(['gzip','deflate','br']).to.include(enc);",
                      "    } else {",
                      "        console.log('INFO: No compression header detected (may be small payload or not configured)');",
                      "    }",
                      "});"
                    ],
                    "type": "text/javascript",
                    "packages": {},
                    "requests": {}
                  }
                }
              ],
              "request": {
                "auth": {
                  "type": "bearer",
                  "bearer": [
                    {
                      "key": "token",
                      "value": "{{auth_token}}",
                      "type": "string"
                    }
                  ]
                },
                "method": "GET",
                "header": [
                  {
                    "key": "Content-Type",
                    "value": "application/json"
                  }
                ],
                "url": {
                  "raw": "{{base_url}}/products",
                  "host": [
                    "{{base_url}}"
                  ],
                  "path": [
                    "products"
                  ]
                },
                "description": "TC-PERF-007 | P2 | Server should compress large responses"
              },
              "response": []
            }
          ]
        }
      ],
      "description": "Response times, caching, compression, and rate-limit validation"
    },
    {
      "name": "Security Tests",
      "item": [
        {
          "name": "Injection Attacks",
          "item": [
            {
              "name": "[SE-001] Login - SQL Injection",
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "exec": [
                      "pm.test('SQL injection blocked (400 or 401, NOT 200)', () => {",
                      "    pm.expect(pm.response.code).to.be.oneOf([400, 401]);",
                      "    pm.expect(pm.response.code).to.not.equal(200);",
                      "});",
                      "",
                      "pm.test('[No SQL engine details in response', () => {",
                      "    const txt = pm.response.text().toLowerCase();",
                      "    pm.expect(txt).to.not.include('sql');",
                      "    pm.expect(txt).to.not.include('mysql');",
                      "    pm.expect(txt).to.not.include('postgres');",
                      "    pm.expect(txt).to.not.include('sqlite');",
                      "    pm.expect(txt).to.not.include('syntax error');",
                      "});",
                      "",
                      "pm.test('No 500 Internal Server Error on injection', () => {",
                      "    pm.expect(pm.response.code).to.not.equal(500);",
                      "});"
                    ],
                    "type": "text/javascript",
                    "packages": {},
                    "requests": {}
                  }
                }
              ],
              "request": {
                "auth": {
                  "type": "noauth"
                },
                "method": "POST",
                "header": [
                  {
                    "key": "Content-Type",
                    "value": "application/json"
                  }
                ],
                "body": {
                  "mode": "raw",
                  "raw": "{\n    \"email\": \"admin'--\",\n    \"password\": \"' OR '1'='1\"\n}",
                  "options": {
                    "raw": {
                      "language": "json"
                    }
                  }
                },
                "url": {
                  "raw": "{{base_url}}/auth/login",
                  "host": [
                    "{{base_url}}"
                  ],
                  "path": [
                    "auth",
                    "login"
                  ]
                },
                "description": "TC-SEC-001 to TC-SEC-003 | P0 | SQL injection must be blocked; no DB errors exposed"
              },
              "response": []
            },
            {
              "name": "[SE-002] Register - XSS Payload",
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "exec": [
                      "pm.test('XSS payload handled (201 sanitised or 400 rejected)', () => {",
                      "    pm.expect(pm.response.code).to.be.oneOf([201, 400]);",
                      "});",
                      "",
                      "if (pm.response.code === 201) {",
                      "    pm.test('Script tags not echoed raw', () => {",
                      "        const txt = pm.response.text().toLowerCase();",
                      "        pm.expect(txt).to.not.include('<script>');",
                      "    });",
                      "}"
                    ],
                    "type": "text/javascript",
                    "packages": {},
                    "requests": {}
                  }
                }
              ],
              "request": {
                "auth": {
                  "type": "noauth"
                },
                "method": "POST",
                "header": [
                  {
                    "key": "Content-Type",
                    "value": "application/json"
                  }
                ],
                "body": {
                  "mode": "raw",
                  "raw": "{\n    \"username\": \"<img src=x onerror=alert(1)>\",\n    \"email\": \"xss2@pentest.com\",\n    \"password\": \"Str0ng!Pass\"\n}",
                  "options": {
                    "raw": {
                      "language": "json"
                    }
                  }
                },
                "url": {
                  "raw": "{{base_url}}/auth/register",
                  "host": [
                    "{{base_url}}"
                  ],
                  "path": [
                    "auth",
                    "register"
                  ]
                },
                "description": "TC-SEC-004 to TC-SEC-005 | P0 | XSS payload sanitised or rejected"
              },
              "response": []
            },
            {
              "name": "[SE-003] Login - NoSQL Injection",
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "exec": [
                      "pm.test('NoSQL injection blocked (400 or 401)', () => {",
                      "    pm.expect(pm.response.code).to.be.oneOf([400, 401]);",
                      "});",
                      "",
                      "pm.test('No MongoDB/NoSQL details leaked', () => {",
                      "    const txt = pm.response.text().toLowerCase();",
                      "    pm.expect(txt).to.not.include('mongo');",
                      "    pm.expect(txt).to.not.include('$where');",
                      "    pm.expect(txt).to.not.include('$ne');",
                      "});"
                    ],
                    "type": "text/javascript",
                    "packages": {},
                    "requests": {}
                  }
                }
              ],
              "request": {
                "auth": {
                  "type": "noauth"
                },
                "method": "POST",
                "header": [
                  {
                    "key": "Content-Type",
                    "value": "application/json"
                  }
                ],
                "body": {
                  "mode": "raw",
                  "raw": "{\n    \"email\": {\"$ne\": null},\n    \"password\": {\"$ne\": null}\n}",
                  "options": {
                    "raw": {
                      "language": "json"
                    }
                  }
                },
                "url": {
                  "raw": "{{base_url}}/auth/login",
                  "host": [
                    "{{base_url}}"
                  ],
                  "path": [
                    "auth",
                    "login"
                  ]
                },
                "description": "TC-SEC-006 to TC-SEC-007 | P0 | NoSQL operator injection blocked"
              },
              "response": []
            }
          ]
        },
        {
          "name": "HTTP Method Security",
          "item": [
            {
              "name": "[SE-004] GET /auth/login - Wrong Method",
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "exec": [
                      "pm.test('GET on /auth/login returns 405 Method Not Allowed', () => {",
                      "    pm.expect(pm.response.code).to.be.oneOf([405, 404]);",
                      "});",
                      "",
                      "if (pm.response.code === 405) {",
                      "    pm.test('Allow header mentions POST', () => {",
                      "        const allow = pm.response.headers.get('Allow') || '';",
                      "        pm.expect(allow.toUpperCase()).to.include('POST');",
                      "    });",
                      "}"
                    ],
                    "type": "text/javascript",
                    "packages": {},
                    "requests": {}
                  }
                }
              ],
              "request": {
                "auth": {
                  "type": "noauth"
                },
                "method": "GET",
                "header": [
                  {
                    "key": "Content-Type",
                    "value": "application/json"
                  }
                ],
                "url": {
                  "raw": "{{base_url}}/auth/login",
                  "host": [
                    "{{base_url}}"
                  ],
                  "path": [
                    "auth",
                    "login"
                  ]
                },
                "description": "TC-SEC-014 to TC-SEC-015 | P1 | GET on POST-only endpoint returns 405"
              },
              "response": []
            },
            {
              "name": "[SE-005] POST /products - Wrong Method",
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "exec": [
                      "pm.test('POST on /products returns 405', () => {",
                      "    pm.expect(pm.response.code).to.be.oneOf([405, 404]);",
                      "});"
                    ],
                    "type": "text/javascript",
                    "packages": {},
                    "requests": {}
                  }
                }
              ],
              "request": {
                "auth": {
                  "type": "bearer",
                  "bearer": [
                    {
                      "key": "token",
                      "value": "{{access_token}}",
                      "type": "string"
                    }
                  ]
                },
                "method": "POST",
                "header": [
                  {
                    "key": "Content-Type",
                    "value": "application/json"
                  }
                ],
                "body": {
                  "mode": "raw",
                  "raw": "{}",
                  "options": {
                    "raw": {
                      "language": "json"
                    }
                  }
                },
                "url": {
                  "raw": "{{base_url}}/products/{{product_id}}",
                  "host": [
                    "{{base_url}}"
                  ],
                  "path": [
                    "products",
                    "{{product_id}}"
                  ]
                },
                "description": "TC-SEC-016 | P1 | POST on GET-only endpoint returns 405"
              },
              "response": []
            }
          ]
        },
        {
          "name": "Security Headers",
          "item": [
            {
              "name": "[SE-006] GET /auth/login - Security Headers Audit",
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "exec": [
                      "pm.test('X-Powered-By header NOT exposed', () => {",
                      "    pm.expect(pm.response.headers.has('X-Powered-By')).to.be.false;",
                      "});",
                      "",
                      "pm.test('Server header does not reveal version number', () => {",
                      "    const srv = pm.response.headers.get('Server') || '';",
                      "    pm.expect(srv).to.not.match(/\\d+\\.\\d+/);",
                      "});",
                      "",
                      "pm.test('Security headers present (informational)', () => {",
                      "    const xct = pm.response.headers.has('X-Content-Type-Options');",
                      "    const xfo = pm.response.headers.has('X-Frame-Options');",
                      "    const sts = pm.response.headers.has('Strict-Transport-Security');",
                      "    console.log('X-Content-Type-Options:', xct, '| X-Frame-Options:', xfo, '| HSTS:', sts);",
                      "    pm.expect(true).to.be.true; // informational — mark critical in your project",
                      "});"
                    ],
                    "type": "text/javascript",
                    "packages": {},
                    "requests": {}
                  }
                }
              ],
              "request": {
                "auth": {
                  "type": "noauth"
                },
                "method": "GET",
                "header": [
                  {
                    "key": "Content-Type",
                    "value": "application/json"
                  }
                ],
                "url": {
                  "raw": "{{base_url}}/auth/login",
                  "host": [
                    "{{base_url}}"
                  ],
                  "path": [
                    "auth",
                    "login"
                  ]
                },
                "description": "TC-SEC-017 to TC-SEC-019 | P1 | X-Powered-By hidden; no version leak; HSTS/CSP logged"
              },
              "response": []
            }
          ]
        }
      ],
      "description": "OWASP Top 10 checks — injection, auth bypass, IDOR, HTTP method abuse, headers"
    },
    {
      "name": "E2E WORKFLOWS",
      "item": [
        {
          "name": "Complete User Journey",
          "item": [
            {
              "name": "[FLOW-01] Register",
              "event": [
                {
                  "listen": "prerequest",
                  "script": {
                    "exec": [
                      "const ts = Date.now();",
                      "pm.collectionVariables.set('e2e_email', `e2e_${ts}@test.com`);",
                      "pm.collectionVariables.set('e2e_password', 'E2eStr0ng!Pass');"
                    ],
                    "type": "text/javascript",
                    "packages": {},
                    "requests": {}
                  }
                },
                {
                  "listen": "test",
                  "script": {
                    "exec": [
                      "pm.test('Registration succeeds', () => pm.response.to.have.status(201));",
                      "if(pm.response.code===201){ pm.collectionVariables.set('e2e_token',''); }"
                    ],
                    "type": "text/javascript",
                    "packages": {},
                    "requests": {}
                  }
                }
              ],
              "request": {
                "auth": {
                  "type": "noauth"
                },
                "method": "POST",
                "header": [
                  {
                    "key": "Content-Type",
                    "value": "application/json"
                  }
                ],
                "body": {
                  "mode": "raw",
                  "raw": "{\n    \"email\": \"{{e2e_email}}\",\n    \"password\": \"{{e2e_password}}\",\n    \"name\": \"End User\"\n}",
                  "options": {
                    "raw": {
                      "language": "json"
                    }
                  }
                },
                "url": {
                  "raw": "{{base_url}}/auth/register",
                  "host": [
                    "{{base_url}}"
                  ],
                  "path": [
                    "auth",
                    "register"
                  ]
                },
                "description": "E2E Step 1 — Register a brand-new user"
              },
              "response": []
            },
            {
              "name": "[FLOW-02] Login",
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "exec": [
                      "pm.test('Login succeeds', () => pm.response.to.have.status(200));",
                      "if(pm.response.code===200){ const d=pm.response.json(); pm.collectionVariables.set('e2e_token', d.token||d.accessToken); }"
                    ],
                    "type": "text/javascript",
                    "packages": {},
                    "requests": {}
                  }
                }
              ],
              "request": {
                "auth": {
                  "type": "noauth"
                },
                "method": "POST",
                "header": [
                  {
                    "key": "Content-Type",
                    "value": "application/json"
                  }
                ],
                "body": {
                  "mode": "raw",
                  "raw": "{\n    \"email\": \"{{e2e_email}}\",\n    \"password\": \"{{e2e_password}}\"\n}",
                  "options": {
                    "raw": {
                      "language": "json"
                    }
                  }
                },
                "url": {
                  "raw": "{{base_url}}/auth/login",
                  "host": [
                    "{{base_url}}"
                  ],
                  "path": [
                    "auth",
                    "login"
                  ]
                },
                "description": "E2E Step 2 — Login and store token"
              },
              "response": []
            },
            {
              "name": "[FLOW-03] Access Products",
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "exec": [
                      "pm.test('Products accessible after login', () => pm.response.to.have.status(200));",
                      "",
                      "pm.test(\"Products array exists\", function () {",
                      "    const response = pm.response.json();",
                      "    pm.expect(response).to.have.property(\"products\");",
                      "    pm.expect(response.products).to.be.an(\"array\");",
                      "});"
                    ],
                    "type": "text/javascript",
                    "packages": {},
                    "requests": {}
                  }
                }
              ],
              "request": {
                "auth": {
                  "type": "bearer",
                  "bearer": [
                    {
                      "key": "token",
                      "value": "{{e2e_token}}",
                      "type": "string"
                    }
                  ]
                },
                "method": "GET",
                "header": [
                  {
                    "key": "Content-Type",
                    "value": "application/json"
                  }
                ],
                "url": {
                  "raw": "{{base_url}}/products",
                  "host": [
                    "{{base_url}}"
                  ],
                  "path": [
                    "products"
                  ]
                },
                "description": "E2E Step 5 — Access protected products while authenticated"
              },
              "response": []
            },
            {
              "name": "[FLOW-04] Logout",
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "exec": [
                      "pm.test('Logout succeeds', () => pm.expect(pm.response.code).to.be.oneOf([200,204]));",
                      "pm.collectionVariables.unset('e2e_token');"
                    ],
                    "type": "text/javascript",
                    "packages": {},
                    "requests": {}
                  }
                }
              ],
              "request": {
                "auth": {
                  "type": "bearer",
                  "bearer": [
                    {
                      "key": "token",
                      "value": "{{e2e_token}}",
                      "type": "string"
                    }
                  ]
                },
                "method": "POST",
                "header": [
                  {
                    "key": "Content-Type",
                    "value": "application/json"
                  }
                ],
                "url": {
                  "raw": "{{base_url}}/auth/logout",
                  "host": [
                    "{{base_url}}"
                  ],
                  "path": [
                    "auth",
                    "logout"
                  ]
                },
                "description": "E2E Step 6 — Logout and clear token"
              },
              "response": []
            },
            {
              "name": "[FLOW-05] Post-Logout Access Denied",
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "exec": [
                      "pm.test('Access denied after logout (401)', () => pm.response.to.have.status(401));"
                    ],
                    "type": "text/javascript",
                    "packages": {},
                    "requests": {}
                  }
                }
              ],
              "request": {
                "auth": {
                  "type": "bearer",
                  "bearer": [
                    {
                      "key": "token",
                      "value": "{{e2e_token}}",
                      "type": "string"
                    }
                  ]
                },
                "method": "GET",
                "header": [
                  {
                    "key": "Content-Type",
                    "value": "application/json"
                  }
                ],
                "url": {
                  "raw": "{{base_url}}/products",
                  "host": [
                    "{{base_url}}"
                  ],
                  "path": [
                    "products"
                  ]
                },
                "description": "E2E Step 7 — Confirm cleared token returns 401"
              },
              "response": []
            }
          ],
          "description": "7-step journey: Register → Login → Profile → Update → Products → Logout → Verify Denied"
        }
      ],
      "description": "End-to-end user flows — complete session lifecycle"
    }
  ],
  "event": [
    {
      "listen": "prerequest",
      "script": {
        "type": "text/javascript",
        "requests": {},
        "exec": [
          "// ─── GLOBAL PRE-REQUEST ───────────────────────────────────────────────",
          "pm.environment.set('req_start', Date.now());",
          "console.log('▶ REQUEST:', pm.request.method, pm.request.url.getPath());"
        ]
      }
    },
    {
      "listen": "test",
      "script": {
        "type": "text/javascript",
        "requests": {},
        "exec": [
          "// ─── GLOBAL TEST ",
          "const elapsed = Date.now() - Number(pm.environment.get('req_start'));",
          "console.log('◀ RESPONSE:', pm.response.code, '|', elapsed + 'ms', '|', pm.response.size().total + ' bytes');",
          "// ── Reusable helper library ",
          "const LIB = {",
          "validEmail: (e) => /^[^\\s@]+@[^\\s@]+\\.[^\\s@]+$/.test(e),",
          "validJWT:   (t) => typeof t === 'string' && t.split('.').length === 3,",
          "noSqlLeak:  (body) => {",
          "const b = body.toLowerCase();",
          "return !b.includes('sql') && !b.includes('mysql') &&",
          "!b.includes('postgres') && !b.includes('sqlite') &&",
          "!b.includes('mongo') && !b.includes('syntax error');",
          "    },",
          "recordMetric: (key, val) => {",
          "const raw = pm.environment.get('_metrics') || '{}';",
          "const m = JSON.parse(raw);",
          "if (!m[key]) m[key] = [];",
          "        m[key].push(val);",
          "        pm.environment.set('_metrics', JSON.stringify(m));",
          "    }",
          "};",
          "pm.globals.set('LIB', JSON.stringify(LIB));"
        ]
      }
    }
  ],
  "variable": [
    {
      "key": "base_url",
      "value": "http://localhost:3000"
    },
    {
      "key": "reg_email",
      "value": ""
    },
    {
      "key": "reg_password",
      "value": ""
    },
    {
      "key": "reg_user_id",
      "value": ""
    },
    {
      "key": "user_id",
      "value": ""
    },
    {
      "key": "tampered_token",
      "value": ""
    },
    {
      "key": "e2e_email",
      "value": ""
    },
    {
      "key": "_metrics",
      "value": "{}"
    },
    {
      "key": "reg_username",
      "value": ""
    },
    {
      "key": "reg_saved_email",
      "value": ""
    },
    {
      "key": "expired_token",
      "value": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VySWQiOiI2OTkyOWFlN2I2MTY0MGMxYjc3YTYxZDgiLCJpYXQiOjE3NzEyMTU1OTYsImV4cCI6MTc3MTIxNjEzN30=.kuSwem-AWylQRUJRU2Ru3Qs6-fY3PNemo1vMzq-tEns"
    },
    {
      "key": "user_email",
      "value": ""
    },
    {
      "key": "access_token",
      "value": ""
    },
    {
      "key": "product_id",
      "value": ""
    },
    {
      "key": "e2e_password",
      "value": ""
    },
    {
      "key": "refresh_token",
      "value": ""
    }
  ]
}